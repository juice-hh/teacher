<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ•°æ®åˆå§‹åŒ–å·¥å…·</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 12px;
      padding: 40px;
      max-width: 600px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    h1 {
      color: #333;
      margin-bottom: 20px;
      font-size: 28px;
    }

    .status {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
    }

    .status.info {
      background: #e6f7ff;
      border-left: 4px solid #1890ff;
      color: #0050b3;
    }

    .status.success {
      background: #f6ffed;
      border-left: 4px solid #52c41a;
      color: #389e0d;
    }

    .status.warning {
      background: #fff7e6;
      border-left: 4px solid #fa8c16;
      color: #d46b08;
    }

    .button {
      display: block;
      width: 100%;
      padding: 15px 30px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      margin-bottom: 15px;
    }

    .button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
    }

    .button:active {
      transform: translateY(0);
    }

    .button.secondary {
      background: #f0f0f0;
      color: #333;
    }

    .button.secondary:hover {
      background: #e0e0e0;
    }

    .log {
      background: #f5f5f5;
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
      max-height: 300px;
      overflow-y: auto;
    }

    .log-item {
      margin-bottom: 8px;
    }

    .log-item.success {
      color: #52c41a;
    }

    .log-item.error {
      color: #ff4d4f;
    }

    .log-item.info {
      color: #1890ff;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 20px;
    }

    .stat-card {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .stat-number {
      font-size: 32px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 13px;
      color: #666;
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸš€ æ•™å¸ˆè¯„ä»·ç³»ç»Ÿ - æ•°æ®åˆå§‹åŒ–</h1>

    <div id="initial-status" class="status info">
      <strong>â„¹ï¸ è¯´æ˜ï¼š</strong>æ­¤å·¥å…·å°†æ¸…é™¤æ‰€æœ‰ç¼“å­˜æ•°æ®å¹¶é‡æ–°åˆå§‹åŒ–æ¼”ç¤ºæ•°æ®ï¼Œç¡®ä¿æ‰€æœ‰é¡µé¢æ­£å¸¸æ˜¾ç¤ºã€‚
    </div>

    <button id="initBtn" class="button">ğŸ”„ ç«‹å³åˆå§‹åŒ–æ‰€æœ‰æ•°æ®</button>
    <button id="clearBtn" class="button secondary">ğŸ—‘ï¸ ä»…æ¸…é™¤ç¼“å­˜</button>

    <div id="resultArea" class="hidden">
      <div class="stats">
        <div class="stat-card">
          <div class="stat-number" id="materialCount">0</div>
          <div class="stat-label">è¯„ä»·ææ–™</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="scoreCount">0</div>
          <div class="stat-label">æ•™å¸ˆç§¯åˆ†</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="appealCount">0</div>
          <div class="stat-label">ç”³è¯‰è®°å½•</div>
        </div>
      </div>

      <div class="log" id="logArea"></div>
    </div>

    <div id="successArea" class="hidden">
      <div class="status success">
        <strong>âœ… åˆå§‹åŒ–å®Œæˆï¼</strong>é¡µé¢å°†åœ¨ <span id="countdown">3</span> ç§’åè‡ªåŠ¨åˆ·æ–°...
      </div>
    </div>
  </div>

  <script>
    const logArea = document.getElementById('logArea')
    const resultArea = document.getElementById('resultArea')
    const successArea = document.getElementById('successArea')
    const initStatus = document.getElementById('initial-status')

    function log(message, type = 'info') {
      const item = document.createElement('div')
      item.className = `log-item ${type}`
      item.textContent = message
      logArea.appendChild(item)
      logArea.scrollTop = logArea.scrollHeight
    }

    function initData() {
      resultArea.classList.remove('hidden')
      initStatus.classList.add('hidden')
      logArea.innerHTML = ''

      log('ğŸš€ å¼€å§‹æ•°æ®åˆå§‹åŒ–...', 'info')

      // æ¸…é™¤æ—§æ•°æ®
      log('ğŸ“‹ æ­¥éª¤1ï¼šæ¸…é™¤æ—§æ•°æ®...', 'info')
      localStorage.removeItem('evaluationMaterials')
      localStorage.removeItem('evaluationScores')
      localStorage.removeItem('scoreAppeals')
      log('âœ… å·²æ¸…é™¤æ‰€æœ‰æ—§æ•°æ®', 'success')

      // åˆå§‹åŒ–è¯„ä»·ææ–™
      log('ğŸ“¦ æ­¥éª¤2ï¼šåˆå§‹åŒ–è¯„ä»·ææ–™...', 'info')
      const materials = [
        { id: 1, taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 1, indicatorName: 'å¤‡è¯¾å……åˆ†', teacherId: 'T001', teacherName: 'å¼ è€å¸ˆ', materialName: 'æ•™å­¦æ•™æ¡ˆ-æ˜¥å­£å­¦æœŸ', materialType: 'document', fileUrl: '/files/teaching-plan.pdf', description: 'åŒ…å«å®Œæ•´çš„æ•™å­¦æ•™æ¡ˆã€æ•™å­¦æ—¥å†å’Œè¯¾ä»¶', uploadTime: '2024-03-05 10:30:00', status: 'pending', approveTime: null, approver: null, rejectReason: '' },
        { id: 2, taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 5, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', teacherId: 'T001', teacherName: 'å¼ è€å¸ˆ', materialName: 'æ•™å­¦æ”¹é©é¡¹ç›®æˆæœ', materialType: 'document', fileUrl: '/files/teaching-reform.pdf', description: 'æ•™å­¦æ–¹æ³•åˆ›æ–°é¡¹ç›®çš„å®æ–½è®°å½•å’Œæˆæœ', uploadTime: '2024-03-06 14:20:00', status: 'approved', approveTime: '2024-03-07 09:15:00', approver: 'ç®¡ç†å‘˜', rejectReason: '' },
        { id: 3, taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 2, indicatorName: 'è¯¾å ‚ç®¡ç†', teacherId: 'T002', teacherName: 'æè€å¸ˆ', materialName: 'è¯¾å ‚ç®¡ç†è®°å½•', materialType: 'document', fileUrl: '/files/class-management.pdf', description: 'æœ¬å­¦æœŸè¯¾å ‚ç®¡ç†æƒ…å†µè®°å½•', uploadTime: '2024-03-04 16:45:00', status: 'rejected', approveTime: '2024-03-05 11:20:00', approver: 'ç®¡ç†å‘˜', rejectReason: 'ææ–™ä¸å®Œæ•´ï¼Œç¼ºå°‘å­¦ç”Ÿåé¦ˆè®°å½•' },
        { id: 4, taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 8, indicatorName: 'å­¦ç”Ÿè¯„ä»·', teacherId: 'T003', teacherName: 'ç‹è€å¸ˆ', materialName: 'å­¦ç”Ÿè¯„æ•™æ±‡æ€»æŠ¥å‘Š', materialType: 'document', fileUrl: '/files/student-eval.pdf', description: '2024å¹´æ˜¥å­£å­¦æœŸå­¦ç”Ÿè¯„æ•™ç»“æœæ±‡æ€»', uploadTime: '2024-03-07 09:15:00', status: 'pending', approveTime: null, approver: null, rejectReason: '' },
        { id: 5, taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 11, indicatorName: 'å­¦æœ¯ç ”ç©¶', teacherId: 'T003', teacherName: 'ç‹è€å¸ˆ', materialName: 'ç§‘ç ”é¡¹ç›®ç»“é¢˜è¯ä¹¦', materialType: 'document', fileUrl: '/files/research-cert.pdf', description: '2023å¹´åº¦çœçº§ç§‘ç ”é¡¹ç›®ç»“é¢˜ææ–™', uploadTime: '2024-03-08 15:30:00', status: 'pending', approveTime: null, approver: null, rejectReason: '' }
      ]
      localStorage.setItem('evaluationMaterials', JSON.stringify(materials))
      log(`âœ… å·²ä¿å­˜ ${materials.length} æ¡ææ–™æ•°æ®`, 'success')

      // åˆå§‹åŒ–ç§¯åˆ†æ•°æ®
      log('ğŸ“Š æ­¥éª¤3ï¼šåˆå§‹åŒ–ç§¯åˆ†æ•°æ®...', 'info')
      const scores = [
        { id: 1, teacherId: 'T001', teacherName: 'å¼ è€å¸ˆ', department: 'è®¡ç®—æœºå­¦é™¢', semester: '2024å¹´åº¦', totalScore: 92.5, confirmed: true, confirmedBy: null, confirmedAt: '2024-03-15 10:30:00', details: [{ taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 1, indicatorName: 'å¤‡è¯¾å……åˆ†', score: 5, maxScore: 5 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 5, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', score: 7, maxScore: 8 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 8, indicatorName: 'å­¦ç”Ÿè¯„ä»·', score: 9, maxScore: 10 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 11, indicatorName: 'å­¦æœ¯ç ”ç©¶', score: 8.5, maxScore: 10 }] },
        { id: 2, teacherId: 'T002', teacherName: 'æè€å¸ˆ', department: 'æ•°å­¦å­¦é™¢', semester: '2024å¹´åº¦', totalScore: 87.0, confirmed: true, confirmedBy: null, confirmedAt: '2024-03-16 14:20:00', details: [{ taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 1, indicatorName: 'å¤‡è¯¾å……åˆ†', score: 4, maxScore: 5 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 5, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', score: 6, maxScore: 8 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 8, indicatorName: 'å­¦ç”Ÿè¯„ä»·', score: 8.5, maxScore: 10 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 11, indicatorName: 'å­¦æœ¯ç ”ç©¶', score: 7.5, maxScore: 10 }] },
        { id: 3, teacherId: 'T003', teacherName: 'ç‹è€å¸ˆ', department: 'è‹±è¯­å­¦é™¢', semester: '2024å¹´åº¦', totalScore: 95.0, confirmed: false, confirmedBy: null, confirmedAt: null, details: [{ taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 1, indicatorName: 'å¤‡è¯¾å……åˆ†', score: 5, maxScore: 5 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 5, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', score: 8, maxScore: 8 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 8, indicatorName: 'å­¦ç”Ÿè¯„ä»·', score: 9.5, maxScore: 10 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 11, indicatorName: 'å­¦æœ¯ç ”ç©¶', score: 9, maxScore: 10 }] },
        { id: 4, teacherId: 'T004', teacherName: 'èµµè€å¸ˆ', department: 'ç‰©ç†å­¦é™¢', semester: '2024å¹´åº¦', totalScore: 88.5, confirmed: false, confirmedBy: null, confirmedAt: null, details: [{ taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 1, indicatorName: 'å¤‡è¯¾å……åˆ†', score: 4.5, maxScore: 5 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 5, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', score: 6.5, maxScore: 8 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 8, indicatorName: 'å­¦ç”Ÿè¯„ä»·', score: 9, maxScore: 10 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 11, indicatorName: 'å­¦æœ¯ç ”ç©¶', score: 8, maxScore: 10 }] },
        { id: 5, teacherId: 'T005', teacherName: 'é™ˆè€å¸ˆ', department: 'è®¡ç®—æœºå­¦é™¢', semester: '2024å¹´åº¦', totalScore: 91.0, confirmed: true, confirmedBy: 'ç®¡ç†å‘˜', confirmedAt: '2024-03-17 11:00:00', details: [{ taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 1, indicatorName: 'å¤‡è¯¾å……åˆ†', score: 5, maxScore: 5 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 5, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', score: 7.5, maxScore: 8 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 8, indicatorName: 'å­¦ç”Ÿè¯„ä»·', score: 8.5, maxScore: 10 }, { taskId: 1, taskName: '2024å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 11, indicatorName: 'å­¦æœ¯ç ”ç©¶', score: 8, maxScore: 10 }] },
        { id: 6, teacherId: 'T001', teacherName: 'å¼ è€å¸ˆ', department: 'è®¡ç®—æœºå­¦é™¢', semester: '2023å¹´åº¦', totalScore: 89.0, confirmed: true, confirmedBy: 'ç®¡ç†å‘˜', confirmedAt: '2024-01-15 10:30:00', details: [{ taskId: 2, taskName: '2023å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 1, indicatorName: 'å¤‡è¯¾å……åˆ†', score: 4.5, maxScore: 5 }, { taskId: 2, taskName: '2023å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 5, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', score: 6.5, maxScore: 8 }, { taskId: 2, taskName: '2023å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 8, indicatorName: 'å­¦ç”Ÿè¯„ä»·', score: 9, maxScore: 10 }, { taskId: 2, taskName: '2023å¹´åº¦æ•™å¸ˆè‡ªè¯„', indicatorId: 11, indicatorName: 'å­¦æœ¯ç ”ç©¶', score: 8, maxScore: 10 }] }
      ]
      localStorage.setItem('evaluationScores', JSON.stringify(scores))
      log(`âœ… å·²ä¿å­˜ ${scores.length} æ¡ç§¯åˆ†æ•°æ®`, 'success')

      // åˆå§‹åŒ–ç”³è¯‰æ•°æ®
      log('ğŸ“ æ­¥éª¤4ï¼šåˆå§‹åŒ–ç”³è¯‰æ•°æ®...', 'info')
      const appeals = [
        { id: 1, teacherId: 'T003', teacherName: 'ç‹è€å¸ˆ', department: 'è‹±è¯­å­¦é™¢', scoreId: 3, indicatorName: 'æ•™å­¦æ–¹æ³•åˆ›æ–°', originalScore: 7, expectedScore: 8, reason: 'è¯¥æŒ‡æ ‡å®é™…å¾—åˆ†åº”è¯¥æ˜¯8åˆ†ï¼Œç³»ç»Ÿè®¡ç®—é”™è¯¯', status: 'pending', submitTime: '2024-03-20 10:15:00', handler: null, handleTime: null, handleResult: '' },
        { id: 2, teacherId: 'T001', teacherName: 'å¼ è€å¸ˆ', department: 'è®¡ç®—æœºå­¦é™¢', scoreId: 1, indicatorName: 'å­¦ç”Ÿè¯„ä»·', originalScore: 9, expectedScore: 10, reason: 'å­¦ç”Ÿè¯„æ•™åˆ†æ•°åº”è¯¥æ›´é«˜', status: 'approved', submitTime: '2024-03-18 15:30:00', handler: 'ç®¡ç†å‘˜', handleTime: '2024-03-19 09:20:00', handleResult: 'ç»å¤æ ¸ï¼ŒåŒæ„è°ƒæ•´ä¸º10åˆ†' },
        { id: 3, teacherId: 'T004', teacherName: 'èµµè€å¸ˆ', department: 'ç‰©ç†å­¦é™¢', scoreId: 4, indicatorName: 'å­¦æœ¯ç ”ç©¶', originalScore: 7, expectedScore: 9, reason: 'æœ‰ä¸€ç¯‡è®ºæ–‡è¢«é—æ¼ç»Ÿè®¡', status: 'pending', submitTime: '2024-03-21 14:20:00', handler: null, handleTime: null, handleResult: '' },
        { id: 4, teacherId: 'T002', teacherName: 'æè€å¸ˆ', department: 'æ•°å­¦å­¦é™¢', scoreId: 2, indicatorName: 'å¤‡è¯¾å……åˆ†', originalScore: 4, expectedScore: 5, reason: 'æ•™æ¡ˆå®Œæ•´ï¼Œåº”å¾—æ»¡åˆ†', status: 'rejected', submitTime: '2024-03-17 09:30:00', handler: 'ç®¡ç†å‘˜', handleTime: '2024-03-18 10:15:00', handleResult: 'ç»å¤æ ¸ï¼Œæ•™æ¡ˆç¡®å®æœ‰éƒ¨åˆ†å†…å®¹ç¼ºå¤±ï¼Œç»´æŒåŸåˆ†' }
      ]
      localStorage.setItem('scoreAppeals', JSON.stringify(appeals))
      log(`âœ… å·²ä¿å­˜ ${appeals.length} æ¡ç”³è¯‰æ•°æ®`, 'success')

      // æ›´æ–°ç»Ÿè®¡
      document.getElementById('materialCount').textContent = materials.length
      document.getElementById('scoreCount').textContent = scores.length
      document.getElementById('appealCount').textContent = appeals.length

      log('', 'info')
      log('ğŸ‰ æ‰€æœ‰æ¼”ç¤ºæ•°æ®åˆå§‹åŒ–å®Œæˆï¼', 'success')

      // æ˜¾ç¤ºæˆåŠŸä¿¡æ¯å¹¶å€’è®¡æ—¶
      successArea.classList.remove('hidden')
      let countdown = 3
      const timer = setInterval(() => {
        countdown--
        document.getElementById('countdown').textContent = countdown
        if (countdown <= 0) {
          clearInterval(timer)
          log('â™»ï¸ æ­£åœ¨åˆ·æ–°é¡µé¢...', 'info')
          setTimeout(() => {
            window.location.href = 'http://localhost:3001'
          }, 500)
        }
      }, 1000)
    }

    function clearData() {
      resultArea.classList.remove('hidden')
      initStatus.classList.add('hidden')
      logArea.innerHTML = ''

      log('ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰ç¼“å­˜æ•°æ®...', 'info')
      localStorage.removeItem('evaluationMaterials')
      localStorage.removeItem('evaluationScores')
      localStorage.removeItem('scoreAppeals')
      log('âœ… ç¼“å­˜å·²æ¸…é™¤', 'success')
      log('', 'info')
      log('ğŸ’¡ æç¤ºï¼šè¯·åˆ·æ–°åº”ç”¨é¡µé¢ï¼Œæ•°æ®å°†è‡ªåŠ¨é‡æ–°åˆå§‹åŒ–', 'info')
    }

    document.getElementById('initBtn').addEventListener('click', initData)
    document.getElementById('clearBtn').addEventListener('click', clearData)
  </script>
</body>
</html>
