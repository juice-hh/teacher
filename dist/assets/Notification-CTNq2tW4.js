import{o as V,c as L,b as t,w as l,D as v,S as D,r as i,h as a,q as d,j as w,a as u,f as Q,K as W,M as X,N as Y,O as E}from"./index-BQs85f6M.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const h={class:"notification"},ee={class:"card-header"},te={class:"pagination"},le={class:"notification-detail"},oe={class:"detail-title"},ae={class:"detail-info"},ne={class:"info-item"},ie={class:"info-item"},se={class:"detail-content"},de={__name:"Notification",setup(ue){const m=v(!1),g=v(!1),C=v(!1),x=v(null),f=v({}),_=D({page:1,size:10,total:0}),n=D({title:"",type:"系统通知",receiver:"all",content:"",sendType:"now",scheduleTime:null}),S={title:[{required:!0,message:"请输入通知标题",trigger:"blur"}],type:[{required:!0,message:"请选择通知类型",trigger:"change"}],receiver:[{required:!0,message:"请选择接收对象",trigger:"change"}],content:[{required:!0,message:"请输入通知内容",trigger:"blur"}]},z=v([{id:1,title:"2024年度教师自评通知",type:"评价通知",sender:"管理员",sendTime:"2024-02-20 10:00:00",readCount:96,totalCount:128,status:"已发布",content:"请各位教师在2024年3月31日前完成年度自我评价..."},{id:2,title:"系统维护通知",type:"系统通知",sender:"管理员",sendTime:"2024-02-18 15:00:00",readCount:125,totalCount:128,status:"已发布",content:"系统将于2月25日凌晨2:00-4:00进行维护，届时将无法访问..."},{id:3,title:"评分标准更新说明",type:"公告",sender:"管理员",sendTime:"2024-02-15 09:00:00",readCount:120,totalCount:128,status:"已发布",content:"根据学校要求，本次评价指标体系进行了以下调整..."}]);_.total=z.value.length;function j(s){return{系统通知:"info",评价通知:"primary",任务提醒:"warning",公告:"success"}[s]||"info"}function F(){C.value=!1,Object.assign(n,{title:"",type:"系统通知",receiver:"all",content:"",sendType:"now",scheduleTime:null}),m.value=!0}function M(s){C.value=!0,Object.assign(n,{...s}),m.value=!0}function O(){var s;(s=x.value)==null||s.validate(e=>{e&&(m.value=!1,E.success(n.sendType==="draft"?"草稿保存成功":"通知发布成功"))})}function R(s){f.value=s,g.value=!0}function A(s){Y.confirm(`确定要撤回通知「${s.title}」吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{E.success("通知已撤回")})}return(s,e)=>{const y=i("el-button"),r=i("el-table-column"),k=i("el-tag"),T=i("el-link"),U=i("el-divider"),I=i("el-table"),K=i("el-pagination"),P=i("el-card"),N=i("el-input"),c=i("el-form-item"),b=i("el-option"),G=i("el-select"),p=i("el-radio"),B=i("el-radio-group"),H=i("el-date-picker"),J=i("el-form"),$=i("el-dialog");return V(),L("div",h,[t(P,{class:"page-card",shadow:"hover"},{header:l(()=>[u("div",ee,[e[13]||(e[13]=u("span",{class:"card-title"},"系统通知",-1)),t(y,{type:"primary",icon:Q(W),onClick:F},{default:l(()=>[...e[12]||(e[12]=[a(" 发布通知 ",-1)])]),_:1},8,["icon"])])]),default:l(()=>[t(I,{data:z.value,style:{width:"100%"}},{default:l(()=>[t(r,{prop:"title",label:"通知标题",width:"300"}),t(r,{prop:"type",label:"类型",width:"100"},{default:l(({row:o})=>[t(k,{type:j(o.type),size:"small"},{default:l(()=>[a(d(o.type),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"sender",label:"发布人",width:"120"}),t(r,{prop:"sendTime",label:"发布时间",width:"180"}),t(r,{prop:"readCount",label:"已读/总数",width:"120"},{default:l(({row:o})=>[a(d(o.readCount)+" / "+d(o.totalCount),1)]),_:1}),t(r,{prop:"status",label:"状态",width:"100"},{default:l(({row:o})=>[t(k,{type:o.status==="已发布"?"success":"info",size:"small"},{default:l(()=>[a(d(o.status),1)]),_:2},1032,["type"])]),_:1}),t(r,{label:"操作",width:"200",fixed:"right"},{default:l(({row:o})=>[t(T,{type:"primary",underline:!1,onClick:q=>R(o)},{default:l(()=>[...e[14]||(e[14]=[a("查看",-1)])]),_:1},8,["onClick"]),t(U,{direction:"vertical"}),o.status==="草稿"?(V(),w(T,{key:0,type:"primary",underline:!1,onClick:q=>M(o)},{default:l(()=>[...e[15]||(e[15]=[a(" 编辑 ",-1)])]),_:1},8,["onClick"])):(V(),w(T,{key:1,type:"danger",underline:!1,onClick:q=>A(o)},{default:l(()=>[...e[16]||(e[16]=[a(" 撤回 ",-1)])]),_:1},8,["onClick"]))]),_:1})]),_:1},8,["data"]),u("div",te,[t(K,{"current-page":_.page,"onUpdate:currentPage":e[0]||(e[0]=o=>_.page=o),"page-size":_.size,"onUpdate:pageSize":e[1]||(e[1]=o=>_.size=o),"page-sizes":[10,20,50],total:_.total,layout:"total, sizes, prev, pager, next"},null,8,["current-page","page-size","total"])])]),_:1}),t($,{modelValue:m.value,"onUpdate:modelValue":e[9]||(e[9]=o=>m.value=o),title:C.value?"编辑通知":"发布通知",width:"700px"},{footer:l(()=>[t(y,{onClick:e[8]||(e[8]=o=>m.value=!1)},{default:l(()=>[...e[24]||(e[24]=[a("取消",-1)])]),_:1}),t(y,{type:"primary",onClick:O},{default:l(()=>[...e[25]||(e[25]=[a("确定",-1)])]),_:1})]),default:l(()=>[t(J,{model:n,rules:S,ref_key:"notificationFormRef",ref:x,"label-width":"100px"},{default:l(()=>[t(c,{label:"通知标题",prop:"title"},{default:l(()=>[t(N,{modelValue:n.title,"onUpdate:modelValue":e[2]||(e[2]=o=>n.title=o),placeholder:"请输入通知标题"},null,8,["modelValue"])]),_:1}),t(c,{label:"通知类型",prop:"type"},{default:l(()=>[t(G,{modelValue:n.type,"onUpdate:modelValue":e[3]||(e[3]=o=>n.type=o),placeholder:"请选择"},{default:l(()=>[t(b,{label:"系统通知",value:"系统通知"}),t(b,{label:"评价通知",value:"评价通知"}),t(b,{label:"任务提醒",value:"任务提醒"}),t(b,{label:"公告",value:"公告"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"接收对象",prop:"receiver"},{default:l(()=>[t(B,{modelValue:n.receiver,"onUpdate:modelValue":e[4]||(e[4]=o=>n.receiver=o)},{default:l(()=>[t(p,{value:"all"},{default:l(()=>[...e[17]||(e[17]=[a("全体用户",-1)])]),_:1}),t(p,{value:"teacher"},{default:l(()=>[...e[18]||(e[18]=[a("仅教师",-1)])]),_:1}),t(p,{value:"admin"},{default:l(()=>[...e[19]||(e[19]=[a("仅管理员",-1)])]),_:1}),t(p,{value:"custom"},{default:l(()=>[...e[20]||(e[20]=[a("自定义",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"通知内容",prop:"content"},{default:l(()=>[t(N,{modelValue:n.content,"onUpdate:modelValue":e[5]||(e[5]=o=>n.content=o),type:"textarea",rows:8,placeholder:"请输入通知内容"},null,8,["modelValue"])]),_:1}),t(c,{label:"发布方式"},{default:l(()=>[t(B,{modelValue:n.sendType,"onUpdate:modelValue":e[6]||(e[6]=o=>n.sendType=o)},{default:l(()=>[t(p,{value:"now"},{default:l(()=>[...e[21]||(e[21]=[a("立即发布",-1)])]),_:1}),t(p,{value:"schedule"},{default:l(()=>[...e[22]||(e[22]=[a("定时发布",-1)])]),_:1}),t(p,{value:"draft"},{default:l(()=>[...e[23]||(e[23]=[a("保存草稿",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),n.sendType==="schedule"?(V(),w(c,{key:0,label:"发布时间"},{default:l(()=>[t(H,{modelValue:n.scheduleTime,"onUpdate:modelValue":e[7]||(e[7]=o=>n.scheduleTime=o),type:"datetime",placeholder:"选择发布时间"},null,8,["modelValue"])]),_:1})):X("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t($,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=o=>g.value=o),title:"通知详情",width:"600px"},{footer:l(()=>[t(y,{onClick:e[10]||(e[10]=o=>g.value=!1)},{default:l(()=>[...e[26]||(e[26]=[a("关闭",-1)])]),_:1})]),default:l(()=>[u("div",le,[u("h3",oe,d(f.value.title),1),u("div",ae,[t(k,{size:"small"},{default:l(()=>[a(d(f.value.type),1)]),_:1}),u("span",ne,"发布人："+d(f.value.sender),1),u("span",ie,"发布时间："+d(f.value.sendTime),1)]),t(U),u("div",se,d(f.value.content),1)])]),_:1},8,["modelValue"])])}}},me=Z(de,[["__scopeId","data-v-3c936038"]]);export{me as default};
