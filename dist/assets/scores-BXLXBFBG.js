import{T as y,D as l,y as u}from"./index-BQs85f6M.js";const b=y("score",()=>{const r=l([]),o=l([]),i=[{id:1,teacherId:"T001",teacherName:"张老师",department:"计算机学院",semester:"2024年度",totalScore:92.5,confirmed:!0,confirmedBy:null,confirmedAt:"2024-03-15 10:30:00",details:[{taskId:1,taskName:"2024年度教师自评",indicatorId:1,indicatorName:"备课充分",score:5,maxScore:5},{taskId:1,taskName:"2024年度教师自评",indicatorId:5,indicatorName:"教学方法创新",score:7,maxScore:8},{taskId:1,taskName:"2024年度教师自评",indicatorId:8,indicatorName:"学生评价",score:9,maxScore:10},{taskId:1,taskName:"2024年度教师自评",indicatorId:11,indicatorName:"学术研究",score:8.5,maxScore:10}]},{id:2,teacherId:"T002",teacherName:"李老师",department:"数学学院",semester:"2024年度",totalScore:87,confirmed:!0,confirmedBy:null,confirmedAt:"2024-03-16 14:20:00",details:[{taskId:1,taskName:"2024年度教师自评",indicatorId:1,indicatorName:"备课充分",score:4,maxScore:5},{taskId:1,taskName:"2024年度教师自评",indicatorId:5,indicatorName:"教学方法创新",score:6,maxScore:8},{taskId:1,taskName:"2024年度教师自评",indicatorId:8,indicatorName:"学生评价",score:8.5,maxScore:10},{taskId:1,taskName:"2024年度教师自评",indicatorId:11,indicatorName:"学术研究",score:7.5,maxScore:10}]},{id:3,teacherId:"T003",teacherName:"王老师",department:"英语学院",semester:"2024年度",totalScore:95,confirmed:!1,confirmedBy:null,confirmedAt:null,details:[{taskId:1,taskName:"2024年度教师自评",indicatorId:1,indicatorName:"备课充分",score:5,maxScore:5},{taskId:1,taskName:"2024年度教师自评",indicatorId:5,indicatorName:"教学方法创新",score:8,maxScore:8},{taskId:1,taskName:"2024年度教师自评",indicatorId:8,indicatorName:"学生评价",score:9.5,maxScore:10},{taskId:1,taskName:"2024年度教师自评",indicatorId:11,indicatorName:"学术研究",score:9,maxScore:10}]},{id:4,teacherId:"T004",teacherName:"赵老师",department:"物理学院",semester:"2024年度",totalScore:88.5,confirmed:!1,confirmedBy:null,confirmedAt:null,details:[{taskId:1,taskName:"2024年度教师自评",indicatorId:1,indicatorName:"备课充分",score:4.5,maxScore:5},{taskId:1,taskName:"2024年度教师自评",indicatorId:5,indicatorName:"教学方法创新",score:6.5,maxScore:8},{taskId:1,taskName:"2024年度教师自评",indicatorId:8,indicatorName:"学生评价",score:9,maxScore:10},{taskId:1,taskName:"2024年度教师自评",indicatorId:11,indicatorName:"学术研究",score:8,maxScore:10}]},{id:5,teacherId:"T005",teacherName:"陈老师",department:"计算机学院",semester:"2024年度",totalScore:91,confirmed:!0,confirmedBy:"管理员",confirmedAt:"2024-03-17 11:00:00",details:[{taskId:1,taskName:"2024年度教师自评",indicatorId:1,indicatorName:"备课充分",score:5,maxScore:5},{taskId:1,taskName:"2024年度教师自评",indicatorId:5,indicatorName:"教学方法创新",score:7.5,maxScore:8},{taskId:1,taskName:"2024年度教师自评",indicatorId:8,indicatorName:"学生评价",score:8.5,maxScore:10},{taskId:1,taskName:"2024年度教师自评",indicatorId:11,indicatorName:"学术研究",score:8,maxScore:10}]},{id:6,teacherId:"T001",teacherName:"张老师",department:"计算机学院",semester:"2023年度",totalScore:89,confirmed:!0,confirmedBy:"管理员",confirmedAt:"2024-01-15 10:30:00",details:[{taskId:2,taskName:"2023年度教师自评",indicatorId:1,indicatorName:"备课充分",score:4.5,maxScore:5},{taskId:2,taskName:"2023年度教师自评",indicatorId:5,indicatorName:"教学方法创新",score:6.5,maxScore:8},{taskId:2,taskName:"2023年度教师自评",indicatorId:8,indicatorName:"学生评价",score:9,maxScore:10},{taskId:2,taskName:"2023年度教师自评",indicatorId:11,indicatorName:"学术研究",score:8,maxScore:10}]}],s=[{id:1,teacherId:"T003",teacherName:"王老师",department:"英语学院",scoreId:3,indicatorName:"教学方法创新",originalScore:7,expectedScore:8,reason:"该指标实际得分应该是8分，系统计算错误",status:"pending",submitTime:"2024-03-20 10:15:00",handler:null,handleTime:null,handleResult:""},{id:2,teacherId:"T001",teacherName:"张老师",department:"计算机学院",scoreId:1,indicatorName:"学生评价",originalScore:9,expectedScore:10,reason:"学生评教分数应该更高",status:"approved",submitTime:"2024-03-18 15:30:00",handler:"管理员",handleTime:"2024-03-19 09:20:00",handleResult:"经复核，同意调整为10分"},{id:3,teacherId:"T004",teacherName:"赵老师",department:"物理学院",scoreId:4,indicatorName:"学术研究",originalScore:7,expectedScore:9,reason:"有一篇论文被遗漏统计",status:"pending",submitTime:"2024-03-21 14:20:00",handler:null,handleTime:null,handleResult:""},{id:4,teacherId:"T002",teacherName:"李老师",department:"数学学院",scoreId:2,indicatorName:"备课充分",originalScore:4,expectedScore:5,reason:"教案完整，应得满分",status:"rejected",submitTime:"2024-03-17 09:30:00",handler:"管理员",handleTime:"2024-03-18 10:15:00",handleResult:"经复核，教案确实有部分内容缺失，维持原分"}],S=u(()=>{const t=new Set;return r.value.forEach(e=>t.add(e.semester)),Array.from(t).sort().reverse()}),N=u(()=>o.value.filter(t=>t.status==="pending")),I=()=>{const t=localStorage.getItem("evaluationScores"),e=localStorage.getItem("scoreAppeals");if(t)try{const a=JSON.parse(t);r.value=a&&a.length>0?a:[...i]}catch{r.value=[...i]}else r.value=[...i];if(e)try{const a=JSON.parse(e);o.value=a&&a.length>0?a:[...s]}catch{o.value=[...s]}else o.value=[...s];n()},n=()=>{localStorage.setItem("evaluationScores",JSON.stringify(r.value)),localStorage.setItem("scoreAppeals",JSON.stringify(o.value))},m=t=>r.value.filter(e=>e.semester===t),h=t=>{const e=m(t);return e.length===0?{total:0,confirmed:0,unconfirmed:0,avgScore:0,maxScore:0,minScore:0}:{total:e.length,confirmed:e.filter(a=>a.confirmed).length,unconfirmed:e.filter(a=>!a.confirmed).length,avgScore:e.reduce((a,d)=>a+d.totalScore,0)/e.length,maxScore:Math.max(...e.map(a=>a.totalScore)),minScore:Math.min(...e.map(a=>a.totalScore))}},f=(t,e)=>{const a=r.value.find(d=>d.id===t);return a?(a.confirmed=!0,a.confirmedBy=e,a.confirmedAt=new Date().toLocaleString("zh-CN"),n(),!0):!1},p=(t,e)=>{const a=m(t);let d=0;return a.forEach(c=>{c.confirmed||(c.confirmed=!0,c.confirmedBy=e,c.confirmedAt=new Date().toLocaleString("zh-CN"),d++)}),n(),d},k=(t,e,a,d)=>{const c=o.value.find(A=>A.id===t);return c?(c.handler=e,c.handleTime=new Date().toLocaleString("zh-CN"),c.handleResult=a,c.status=d,n(),!0):!1},g=t=>{const e={id:Date.now(),...t,status:"pending",submitTime:new Date().toLocaleString("zh-CN"),handler:null,handleTime:null,handleResult:""};return o.value.push(e),n(),e},x=()=>{r.value=[...i],o.value=[...s],n()},v=t=>r.value.filter(e=>e.teacherId===t),T=t=>o.value.filter(e=>e.teacherId===t);return I(),{scores:r,appeals:o,semesters:S,pendingAppeals:N,getScoresBySemester:m,getSemesterStats:h,getTeacherScores:v,getTeacherAppeals:T,confirmScore:f,batchConfirmScores:p,handleAppeal:k,submitAppeal:g,saveScores:n,resetScores:x}});export{b as u};
